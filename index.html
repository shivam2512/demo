<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Notes + SQL Assignment</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; background: #f5f5f5; }
    h2 { margin-top: 30px; }
    .section { background: white; padding: 20px; border-radius: 8px; margin-bottom: 30px; box-shadow: 0 0 10px rgba(0,0,0,0.1); }
    textarea { width: 100%; height: 120px; padding: 10px; }
    button { padding: 10px 14px; margin-top: 10px; cursor: pointer; }
    .result-box { background: #fafafa; padding: 10px; border: 1px solid #ddd; border-radius: 6px; }
    pre { background:#eee; padding:10px; border-radius:5px; }
    .correct { color: green; font-weight: bold; }
    .wrong { color: red; font-weight: bold; }
  </style>
</head>
<body>

  <!-- ========================================= -->
  <!-- ORIGINAL NOTES FEATURE (UNTOUCHED)        -->
  <!-- ========================================= -->
  <div class="section">
    <h2>üìò Practice Notes (Original Feature)</h2>
    <textarea id="notesInput" placeholder="Write your notes here..."></textarea>
    <button onclick="saveNotes()">Save Notes</button>
    <h3>Saved Notes:</h3>
    <div id="notesList"></div>
  </div>

  <!-- ========================================= -->
  <!-- SQL ASSIGNMENT FEATURE (SECOND FEATURE)   -->
  <!-- ========================================= -->
  <div class="section">
    <h2>üìù SQL Assignment</h2>

    <div>
      <strong>Question:</strong>
      <div id="questionBox">Write an SQL query to select all customers whose age is greater than 25</div>
    </div>

    <textarea id="sqlInput" placeholder="Write your SQL answer here..."></textarea>
    <button onclick="submitAssignment()">Submit Answer</button>

    <div id="assignmentResult" class="result-box" style="margin-top:20px;"></div>

    <h3>Overall Performance:</h3>
    <div id="performanceBox" class="result-box"></div>
  </div>

<script>
/* ===================== NOTES FEATURE (UNTOUCHED) ===================== */
let notes = JSON.parse(localStorage.getItem("notesData") || "[]");

function saveNotes() {
  const text = document.getElementById("notesInput").value.trim();
  if (!text) return alert("Write something!");

  notes.push({ text, time: new Date().toLocaleString() });
  localStorage.setItem("notesData", JSON.stringify(notes));
  loadNotes();
  document.getElementById("notesInput").value = "";
}

function loadNotes() {
  let html = notes.map(n => `<div><strong>${n.time}</strong><br>${n.text}<hr></div>`).join('');
  document.getElementById("notesList").innerHTML = html;
}

loadNotes();

/* ===================== ASSIGNMENT FEATURE ===================== */
let expectedAnswer = /select \* from customers where age > 25/i;
let total = 0;
let correct = 0;

function submitAssignment() {
  const userSQL = document.getElementById("sqlInput").value.trim();
  if (!userSQL) return alert("Please write your SQL answer.");

  total++;
  let isCorrect = expectedAnswer.test(userSQL);
  if (isCorrect) correct++;

  // Show result with correct answer if wrong
  document.getElementById("assignmentResult").innerHTML = `
    <div class="${isCorrect ? 'correct' : 'wrong'}">
      ${isCorrect ? '‚úî Correct Answer' : '‚úò Wrong Answer'}
    </div>
    <h4>Your Answer:</h4>
    <pre>${userSQL}</pre>
    ${!isCorrect ? `<h4>Correct Answer:</h4><pre>SELECT * FROM customers WHERE age > 25;</pre>` : ''}
  `;

  updatePerformance();
}

function updatePerformance() {
  const percentage = total ? ((correct / total) * 100).toFixed(2) : 0;

  document.getElementById("performanceBox").innerHTML = `
    <strong>Total Questions Attempted:</strong> ${total}<br>
    <strong>Correct Answers:</strong> ${correct}<br>
    <strong>Score:</strong> ${percentage}%
  `;
}
</script>

</body>
</html>
